[1mStep [0m[1;36m1[0m[1m: Analyzing Dataset[0m

[1mAnalyzing dataset[0m[1;33m...[0m
[3m                          Dataset Statistics                          [0m
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━┳━━━━━━━━━━━━┓
┃[1m [0m[1mClass                                        [0m[1m [0m┃[1m [0m[1mCount[0m[1m [0m┃[1m [0m[1mPercentage[0m[1m [0m┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━╇━━━━━━━━━━━━┩
│[36m [0m[36mTomato___Bacterial_spot                      [0m[36m [0m│[35m [0m[35m2127 [0m[35m [0m│[32m [0m[32m11.71%    [0m[32m [0m│
│[36m [0m[36mTomato___Early_blight                        [0m[36m [0m│[35m [0m[35m1000 [0m[35m [0m│[32m [0m[32m5.51%     [0m[32m [0m│
│[36m [0m[36mTomato___Late_blight                         [0m[36m [0m│[35m [0m[35m1909 [0m[35m [0m│[32m [0m[32m10.51%    [0m[32m [0m│
│[36m [0m[36mTomato___Leaf_Mold                           [0m[36m [0m│[35m [0m[35m952  [0m[35m [0m│[32m [0m[32m5.24%     [0m[32m [0m│
│[36m [0m[36mTomato___Septoria_leaf_spot                  [0m[36m [0m│[35m [0m[35m1771 [0m[35m [0m│[32m [0m[32m9.75%     [0m[32m [0m│
│[36m [0m[36mTomato___Spider_mites Two-spotted_spider_mite[0m[36m [0m│[35m [0m[35m1676 [0m[35m [0m│[32m [0m[32m9.23%     [0m[32m [0m│
│[36m [0m[36mTomato___Target_Spot                         [0m[36m [0m│[35m [0m[35m1404 [0m[35m [0m│[32m [0m[32m7.73%     [0m[32m [0m│
│[36m [0m[36mTomato___Tomato_Yellow_Leaf_Curl_Virus       [0m[36m [0m│[35m [0m[35m5357 [0m[35m [0m│[32m [0m[32m29.50%    [0m[32m [0m│
│[36m [0m[36mTomato___Tomato_mosaic_virus                 [0m[36m [0m│[35m [0m[35m373  [0m[35m [0m│[32m [0m[32m2.05%     [0m[32m [0m│
│[36m [0m[36mTomato___healthy                             [0m[36m [0m│[35m [0m[35m1591 [0m[35m [0m│[32m [0m[32m8.76%     [0m[32m [0m│
└───────────────────────────────────────────────┴───────┴────────────┘

[1mImage Size Statistics:[0m
       width  height
count  [1;36m100.0[0m   [1;36m100.0[0m
mean   [1;36m256.0[0m   [1;36m256.0[0m
std      [1;36m0.0[0m     [1;36m0.0[0m
min    [1;36m256.0[0m   [1;36m256.0[0m
[1;36m25[0m%    [1;36m256.0[0m   [1;36m256.0[0m
[1;36m50[0m%    [1;36m256.0[0m   [1;36m256.0[0m
[1;36m75[0m%    [1;36m256.0[0m   [1;36m256.0[0m
max    [1;36m256.0[0m   [1;36m256.0[0m

[1mStep [0m[1;36m2[0m[1m: Loading Data[0m

[1mStep [0m[1;36m3[0m[1m: Visualizing Samples[0m

[1mStep [0m[1;36m4[0m[1m: Initializing Model[0m
/opt/conda/lib/python3.7/site-packages/torch/functional.py:478: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  ../aten/src/ATen/native/TensorShape.cpp:2894.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
Downloading: "https://github.com/SwinTransformer/storage/releases/download/v1.0.0/swin_base_patch4_window7_224_22kto1k.pth" to /home/myuser/.cache/torch/hub/checkpoints/swin_base_patch4_window7_224_22kto1k.pth
Traceback (most recent call last):
  File "train.py", line 161, in <module>
    main()
  File "train.py", line 114, in main
    pretrained=PRETRAINED
  File "/home/myuser/tomato_leaf_disease/models/model_factory.py", line 65, in get_model
    return model_class(num_classes=num_classes, pretrained=pretrained)
  File "/home/myuser/tomato_leaf_disease/models/swin_base.py", line 14, in __init__
    self.model = create_model('swin_base_patch4_window7_224', pretrained=pretrained)
  File "/opt/conda/lib/python3.7/site-packages/timm/models/factory.py", line 71, in create_model
    model = create_fn(pretrained=pretrained, pretrained_cfg=pretrained_cfg, **kwargs)
  File "/opt/conda/lib/python3.7/site-packages/timm/models/swin_transformer.py", line 597, in swin_base_patch4_window7_224
    return _create_swin_transformer('swin_base_patch4_window7_224', pretrained=pretrained, **model_kwargs)
  File "/opt/conda/lib/python3.7/site-packages/timm/models/swin_transformer.py", line 577, in _create_swin_transformer
    **kwargs)
  File "/opt/conda/lib/python3.7/site-packages/timm/models/helpers.py", line 557, in build_model_with_cfg
    strict=pretrained_strict)
  File "/opt/conda/lib/python3.7/site-packages/timm/models/helpers.py", line 249, in load_pretrained
    pretrained_loc, map_location='cpu', progress=_DOWNLOAD_PROGRESS, check_hash=_CHECK_HASH)
  File "/opt/conda/lib/python3.7/site-packages/torch/hub.py", line 727, in load_state_dict_from_url
    download_url_to_file(url, cached_file, hash_prefix, progress=progress)
  File "/opt/conda/lib/python3.7/site-packages/torch/hub.py", line 615, in download_url_to_file
    buffer = u.read(8192)
  File "/opt/conda/lib/python3.7/http/client.py", line 465, in read
    n = self.readinto(b)
  File "/opt/conda/lib/python3.7/http/client.py", line 509, in readinto
    n = self.fp.readinto(b)
  File "/opt/conda/lib/python3.7/socket.py", line 589, in readinto
    return self._sock.recv_into(b)
  File "/opt/conda/lib/python3.7/ssl.py", line 1071, in recv_into
    return self.read(nbytes, buffer)
  File "/opt/conda/lib/python3.7/ssl.py", line 929, in read
    return self._sslobj.read(len, buffer)
ConnectionResetError: [Errno 104] Connection reset by peer
